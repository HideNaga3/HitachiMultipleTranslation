"""
Claude AI による意味的類似度判定（バッチ1: 最初の100ペア）
各ペアについて、意味が同じなら高スコア（90-100%）を付与
"""
import sys
import io
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

import pandas as pd

# 判定結果（Claude AIによる意味的類似度）
# インデックス番号: スコア(0-100)
claude_judgments = {
    0: 80,   # 翻訳サイネージ / 多言語翻訳システム → ほぼ同じ意味
    1: 100,  # 技能実習 / 技能実習 → 完全一致
    2: 100,  # 技能実習生 / 技能実習生 → 完全一致
    3: 100,  # 工場 / 工場 → 完全一致
    4: 90,   # 製造 / 製造業 → ほぼ同じ
    5: 100,  # 機械 / 機械 → 完全一致
    6: 95,   # 安全 / 安全性 → ほぼ同じ
    7: 30,   # 危険（な） / 危険物 → 意味が異なる
    8: 100,  # 危ない / 危険な → 完全に同じ意味
    9: 100,  # 清掃 / クリーニング → 完全に同じ意味
    10: 100, # 非常口 / 非常口 → 完全一致
    11: 100, # 注意 / 注意 → 完全一致
    12: 70,  # 火事 / 火 → 似ているが微妙に違う
    13: 100, # 事故 / 事故 → 完全一致
    14: 100, # 服装 / 服装 → 完全一致
    15: 100, # 安全装置 / 安全装置 → 完全一致
    16: 95,  # 安全カバー / 安全カバー/ガード → ほぼ同じ
    17: 100, # けが / けが → 完全一致
    18: 100, # けがをする / 怪我をする → 完全に同じ意味
    19: 100, # 電源 / 電源 → 完全一致
    20: 100, # 電源を切る / 電源を切る → 完全一致
    21: 100, # 非常停止ボタン / 緊急停止ボタン → 完全に同じ意味
    22: 95,  # 非常停止ボタンを押す / 緊急停止ボタンを押してください → ほぼ同じ
    23: 100, # ルール / ルール → 完全一致
    24: 100, # ルールを守る / ルールに従う → 完全に同じ意味
    25: 100, # 止める / 停止 → 完全に同じ意味
    26: 100, # 機械を止める / 機械を停止する → 完全に同じ意味
    27: 70,  # やって / やってみよう → 似ているが微妙に違う
    28: 90,  # 止めて / やめて → ほぼ同じ
    29: 75,  # 取って / 取ってこい / 持ってくる / 取る → 関連はあるが微妙に違う
    30: 100, # 離して / 放す → 完全に同じ意味
    31: 80,  # 呼んで / 電話して → 似ているが微妙に違う（呼ぶは直接、電話は間接）
    32: 100, # 待って / 待って → 完全一致
    33: 100, # 来て / 来て → 完全一致
    34: 100, # 戻って / 戻ってくる → ほぼ同じ
    35: 100, # 手伝って / 手伝ってください → ほぼ同じ
    36: 100, # 教えて / 教えて → 完全一致
    37: 100, # 見て / 見て → 完全一致
    38: 100, # 確認して / 確認してください → ほぼ同じ
    39: 100, # 報告して / 報告してください → ほぼ同じ
    40: 100, # 連絡して / 連絡してください → ほぼ同じ
    41: 100, # ごみ / ごみ → 完全一致
    42: 95,  # ごみ箱 / ごみ箱 → 完全一致
    43: 100, # 拾って / 拾って → 完全一致
    44: 100, # 捨てて / 捨てて → 完全一致
    45: 100, # 分別 / 分別 → 完全一致
    46: 100, # 危険物 / 危険物 → 完全一致
    47: 100, # 可燃物 / 可燃物 → 完全一致
    48: 100, # 不燃物 / 不燃物 → 完全一致
    49: 100, # 資源 / 資源 → 完全一致
    50: 95,  # 道具 / 道具 → 完全一致
    51: 95,  # 工具 / 工具 → 完全一致
    52: 100, # ハンマー / ハンマー → 完全一致
    53: 100, # ドライバー / ドライバー → 完全一致
    54: 100, # レンチ / レンチ → 完全一致
    55: 100, # ペンチ / ペンチ → 完全一致
    56: 100, # のこぎり / のこぎり → 完全一致
    57: 100, # カッター / カッター → 完全一致
    58: 100, # メジャー / メジャー → 完全一致
    59: 100, # 水平器 / 水平器 → 完全一致
    60: 100, # ドリル / ドリル → 完全一致
    61: 90,  # 電動ドリル / 電動ドリル → 完全一致
    62: 95,  # 救急箱 / 救急キット → ほぼ同じ意味（重要な修正！）
    63: 100, # 消火器 / 消火器 → 完全一致
    64: 100, # ヘルメット / ヘルメット → 完全一致
    65: 100, # 手袋 / 手袋 → 完全一致
    66: 100, # ゴーグル / ゴーグル → 完全一致
    67: 100, # マスク / マスク → 完全一致
    68: 100, # 耳栓 / 耳栓 → 完全一致
    69: 100, # 安全靴 / 安全靴 → 完全一致
    70: 100, # 作業着 / 作業着 → 完全一致
    71: 100, # ベルト / ベルト → 完全一致
    72: 100, # ハーネス / ハーネス → 完全一致
    73: 100, # ロープ / ロープ → 完全一致
    74: 100, # はしご / はしご → 完全一致
    75: 100, # 脚立 / 脚立 → 完全一致
    76: 100, # 足場 / 足場 → 完全一致
    77: 100, # ネット / ネット → 完全一致
    78: 100, # シート / シート → 完全一致
    79: 100, # バリケード / バリケード → 完全一致
    80: 100, # コーン / コーン → 完全一致
    81: 100, # テープ / テープ → 完全一致
    82: 100, # ロープ張り / ロープを張る → ほぼ同じ
    83: 90,  # 立入禁止 / 立ち入り禁止 → ほぼ同じ
    84: 100, # 禁煙 / 禁煙 → 完全一致
    85: 100, # 火気厳禁 / 火気厳禁 → 完全一致
    86: 100, # 高温注意 / 高温注意 → 完全一致
    87: 100, # 感電注意 / 感電注意 → 完全一致
    88: 100, # 落下注意 / 落下注意 → 完全一致
    89: 100, # 転倒注意 / 転倒注意 → 完全一致
    90: 100, # 挟まれ注意 / 挟まれ注意 → 完全一致
    91: 100, # 巻き込まれ注意 / 巻き込まれ注意 → 完全一致
    92: 100, # 切断注意 / 切断注意 → 完全一致
    93: 100, # 飛来注意 / 飛来注意 → 完全一致
    94: 100, # 滑り注意 / 滑り注意 → 完全一致
    95: 100, # 段差注意 / 段差注意 → 完全一致
    96: 100, # 頭上注意 / 頭上注意 → 完全一致
    97: 100, # 足元注意 / 足元注意 → 完全一致
    98: 100, # 指差し確認 / 指差し確認 → 完全一致
    99: 100, # 声出し確認 / 声出し確認 → 完全一致
}

# CSVを読み込み
csv_path = r'C:\python_script\test_space\MitsubishiMultipleTranslation\output\ユニークペア_batch1.csv'
df = pd.read_csv(csv_path, encoding='utf-8-sig', index_col=0)

print('=' * 80)
print('Claude AI 意味的類似度判定（バッチ1）')
print('=' * 80)
print(f'対象: 100ペア')
print()

# 判定結果を追加
df['類似度_claude'] = df.index.map(lambda idx: f'{claude_judgments.get(idx, 50)}%')

# 出力
output_csv = r'C:\python_script\test_space\MitsubishiMultipleTranslation\output\ユニークペア_batch1_claude判定.csv'
df.to_csv(output_csv, index=True, encoding='utf-8-sig')

print(f'✓ 出力: {output_csv}')
print()

# サンプル表示
print('判定結果サンプル（最初の20ペア）:')
print(df[['単語', '再翻訳', '類似度_claude']].head(20).to_string())
print()

# 統計
df['スコア'] = df['類似度_claude'].str.replace('%', '').astype(int)
print('統計情報:')
print(f'  100%（完全一致/完全同義）: {len(df[df["スコア"] == 100])}件')
print(f'  90%以上: {len(df[df["スコア"] >= 90])}件')
print(f'  80%以上: {len(df[df["スコア"] >= 80])}件')
print(f'  50%以上: {len(df[df["スコア"] >= 50])}件')
print(f'  50%未満: {len(df[df["スコア"] < 50])}件')
print(f'  平均スコア: {df["スコア"].mean():.1f}%')
print()
print('=' * 80)
print('完了')
print('=' * 80)
