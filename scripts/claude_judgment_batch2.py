"""
Claude AI による意味的類似度判定（バッチ2: インデックス100-299）
"""
import sys
import io
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

import pandas as pd

# Claude AI判定結果（インデックス: スコア）
claude_judgments = {
    100: 100,  # 地震 / 地震
    101: 100,  # もぐる / 潜る
    102: 100,  # 火気厳禁 / 火気厳禁
    103: 90,   # 開放厳禁 / 閉じたままにしてください/開けないでください
    104: 100,  # 標識 / 標識
    105: 100,  # 気をつける / 気をつけて
    106: 100,  # 持ち込む / 持ち込む
    107: 100,  # 防ぐ / 防ぐ
    108: 100,  # 火 / 火（炎）
    109: 100,  # 煙 / 煙
    110: 100,  # 消火 / 消火/消火活動
    111: 100,  # 消火器 / 消火器
    112: 100,  # 非常ベル / 警報ベル
    113: 95,   # 火災報知機 / 火災警報
    114: 100,  # 逃げる / 逃げる
    115: 95,   # 現場 / 作業現場
    116: 90,   # 作業 / 仕事/タスク
    117: 100,  # ミーティング / ミーティング
    118: 100,  # 研修（する） / トレーニング
    119: 100,  # 実習（する） / 実習
    120: 100,  # あいさつ / 挨拶
    121: 100,  # 確認（する） / 確認
    122: 100,  # 報告（する） / 報告
    123: 100,  # 連絡（する） / 連絡/通知
    124: 100,  # 相談（する） / 相談する
    125: 100,  # 渡す / 渡す
    126: 95,   # 申請書 / 申込書
    127: 70,   # 寝坊（する） / 睡眠不足（意味が少し違う）
    128: 100,  # 技能 / スキル
    129: 85,   # 技能検定試験 / 技能試験/貿易試験（貿易試験は誤訳）
    130: 100,  # 受検（する） / 試験を受ける
    131: 100,  # 資格 / 資格・証明書
    132: 100,  # 手当 / 手当
    133: 100,  # 社員 / 従業員
    134: 90,   # 部長 / ゼネラルマネージャー/部門マネージャー
    135: 100,  # 課長 / 課長
    136: 100,  # 更衣室 / 更衣室・ロッカールーム
    137: 100,  # 台車 / 手押し車/台車
    138: 100,  # 床 / 床
    139: 100,  # 出口 / 出口
    140: 100,  # 電気 / 電気/電力
    141: 100,  # 警報音 / アラーム音
    142: 100,  # コンセント / 電源コンセント/ソケット
    143: 100,  # 作業場 / 作業エリア
    144: 100,  # 作業台 / 作業台
    145: 100,  # 工事現場 / 建設現場
    146: 100,  # 職長 / フォアマン
    147: 100,  # 作業責任者 / 作業監督者・責任者
    148: 100,  # 禁止 / 禁止
    149: 100,  # 表示板 / 看板・表示板
    150: 100,  # 禁止事項 / 禁止事項
    151: 100,  # 避難訓練 / 避難訓練
    152: 100,  # 感電（する） / 感電/感電する
    153: 100,  # 防止（する） / 予防/防止
    154: 100,  # 予防（する） / 予防/防止
    155: 20,   # 転倒（する） / 秋/旅行（完全な誤訳）
    156: 85,   # 挟まる / 詰まる/捕まる
    157: 100,  # 足元 / 足元
    158: 100,  # 不安定（な） / 不安定
    159: 100,  # 後片付け / 後片付け/仕事後の掃除
    160: 95,   # 救急箱 / 救急キット（重要！）
    161: 100,  # 絆創膏 / 包帯/絆創膏
    162: 100,  # 体調 / 体調
    163: 100,  # 血 / 血
    164: 100,  # 熱中症 / 熱中症
    165: 100,  # 吐き気 / 吐き気
    166: 100,  # 嘔吐（する） / 嘔吐
    167: 100,  # 足がつる / 脚のけいれん
    168: 100,  # 気分が悪い / 気分が悪い
    169: 100,  # 寝不足 / 睡眠不足
    170: 100,  # 安全ネット / セーフティネット
    171: 100,  # 安全点検 / 安全検査
    172: 100,  # KY活動（危険予知活動） / KY活動（危険予測）
    173: 100,  # 危険 / 危険
    174: 100,  # ぶつかる / ぶつかる/衝突する
    175: 60,   # 当たる / ヒット/ストライク（文脈による）
    176: 100,  # 下敷きになる / 押さえつけられる
    177: 60,   # 打つ / ヒット/ストライク（文脈による）
    178: 100,  # バランスを崩す / バランスを失う
    179: 100,  # 倒れる / 倒れる/崩壊する
    180: 100,  # 転落（する） / 高所からの落下
    181: 100,  # 指差呼称 / 指差しと呼びかけ
    182: 100,  # ヒヤリハット / ニアミス
    183: 100,  # 原因 / 原因
    184: 100,  # 対策 / 対策
    185: 100,  # 落下（する） / 落下
    186: 100,  # 墜落（する） / 落下（高所から）/急降下
    187: 100,  # 確認（する） / 確認/チェック
    188: 100,  # 作業着 / 作業服
    189: 100,  # 作業服 / 作業服
    190: 100,  # 作業靴 / 安全靴・作業靴
    191: 100,  # 手袋 / 手袋
    192: 100,  # 帽子 / キャップ/帽子
    193: 100,  # 保護帽（ヘルメット） / 安全ヘルメット
    194: 100,  # 保護具 / PPE（個人用保護具）
    195: 100,  # あごひも / あごストラップ
    196: 100,  # ボタン / ボタン
    197: 100,  # ポケット / ポケット
    198: 100,  # 保護メガネ / 安全メガネ
    199: 100,  # マスク / マスク/呼吸器
    200: 85,   # 栓 / プラグ/ストッパー
    201: 100,  # 安全靴 / 安全靴
    202: 100,  # 墜落制止用器具（安全帯） / 墜落制止用器具（安全ベルト・ハーネス）
    203: 90,   # 業務 / 業務/義務/タスク
    204: 100,  # 時間厳守 / 時間厳守
    205: 100,  # 予定 / スケジュール/計画
    206: 100,  # 日付 / 日付
    207: 100,  # 準備（する） / 準備
    208: 100,  # 会議 / 会議/カンファレンス
    209: 100,  # 朝礼 / 朝礼/ツールボックスミーティング
    210: 100,  # 報告書 / 報告
    211: 100,  # マニュアル / マニュアル
    212: 100,  # 作業手順書 / 作業手順書
    213: 100,  # 調子 / 状態/ステータス
    214: 100,  # 立入禁止 / 立入り禁止
    215: 100,  # 禁煙 / 禁煙
    216: 100,  # 駐車禁止 / 駐車禁止
    217: 100,  # 足もと注意 / 足もと注意
    218: 100,  # 開口部注意 / 開口部 - 注意
    219: 100,  # 感電注意 / 電気の危険 - 注意
    220: 100,  # 堕落注意 / 落下の危険 - 注意
    221: 100,  # 頭上注意 / 頭上危険 - 注意
    222: 100,  # 警報設備 / 警報システム
    223: 100,  # AED設置場所 / AEDの場所
    224: 100,  # 保護帽着用 / 安全ヘルメットを着用してください
    225: 100,  # 安全帯使用 / 安全ハーネスを使用する
    226: 100,  # 昇降階段 / アクセス階段
    227: 100,  # 休憩所 / 休憩所
    228: 100,  # 最大積載荷重 / 最大積載量
    229: 100,  # 喫煙所 / 喫煙エリア
    230: 100,  # 整理整頓 / 並べ替えと整頓
    231: 100,  # 安全通路 / 安全な通路
    232: 100,  # 三連クランプ / トリプルクランプ
    233: 100,  # ベルトコンベア / ベルトコンベア
    234: 100,  # かけや / 木槌（かけや）
    235: 100,  # ランマ / ハンドタンピングランマー
    236: 100,  # 自在クランプ / スイベルクランプ
    237: 100,  # キャッチクランプ / キャッチクランプ
    238: 100,  # 吊り上げ用クランプ / リフティングクランプ
    239: 100,  # 直交クランプ / 直角クランプ
    240: 100,  # フック / フック
    241: 100,  # ストレートシャックル / ストレートシャックル
    242: 100,  # 滑車 / ブロック/プーリー
    243: 100,  # クレーン / クレーン
    244: 100,  # 移動式クレーン / 移動式クレーン
    245: 100,  # 介しゃくロープ / タグラインロープ
    246: 100,  # 筋かい止めピン / ブレースピン
    247: 100,  # 脚柱ジョイント / ポストジョイント
    248: 100,  # 連結ピン / 接続ピン
    249: 100,  # ジョイント金具 / ジョイントフィッティング
    250: 100,  # レバーブロック / レバーホイスト（レバーブロック）
    251: 100,  # 電動のこ（丸のこ） / 丸鋸（電動）
    252: 100,  # モンキースパナ / モンキーレンチ
    253: 100,  # 親綱支柱 / ライフラインポスト
    254: 100,  # ブラケット / ブラケット
    255: 100,  # 梯子 / ラダー
    256: 100,  # 親綱 / ライフライン
    257: 100,  # 建枠（ビティ） / フレーム足場（けんわく）
    258: 100,  # メッシュシート / メッシュシート（ネット）
    259: 100,  # 防音パネル / 防音パネル
    260: 100,  # 朝顔材 / キャノピーブラケット（デブリネットサポート）
    261: 100,  # 架空線 / 架空線
    262: 100,  # 幅木（仮設足場） / つま先板（足場）
    263: 100,  # 単管 / 鋼管（単管）
    264: 100,  # 脚立 / 踏み台
    265: 100,  # 作業半径 / 作業半径
    266: 100,  # 仮ボルト / 仮ボルト
    267: 100,  # 手直し / 修正/タッチアップ
    268: 100,  # 面一 / フラッシュ（表面レベル）
    269: 100,  # 点検事項 / 検査項目
    270: 100,  # 積載荷重 / 耐荷重
    271: 100,  # すき間 / ギャップ
    272: 100,  # 通りを見る / アライメントを確認する
    273: 100,  # 組立 / 組み立て/設置
    274: 100,  # 地組 / 地上集合
    275: 100,  # 天端 / 最上層/上面
    276: 100,  # 玉掛け / スリング/リギング
    277: 100,  # 合図 / 信号
    278: 100,  # 定格荷重 / 定格荷重
    279: 100,  # たち / 垂直性
    280: 100,  # 安全帯 / 安全ベルト/ハーネス
    281: 90,   # インサート / 入れる（名詞と動詞で微妙に違う）
    282: 100,  # スペーサ / スペーサー
    283: 100,  # 鉄筋 / 鉄筋
    284: 100,  # 電工ドラム（ドラム） / ケーブルリール/延長リール
    285: 100,  # 電動丸のこ（電のこ） / 丸鋸（電動）
    286: 100,  # パッキン / パッキン/ガスケット
    287: 100,  # 小バール / 小型バール
    288: 100,  # 大バール / 大型バール
    289: 100,  # 化粧合板 / 装飾合板
    290: 100,  # 普通合板 / 標準合板
    291: 100,  # スタイロフォーム / 押出ポリスチレンフォーム
    292: 100,  # 面木 / 面取りストリップ
    293: 100,  # バイブレーター / コンクリートバイブレーター
    294: 100,  # 剥離剤 / 離型剤
    295: 100,  # けこみ板 / ライザーボード
    296: 100,  # 目地棒 / ジョイントロッド/ダボ
    297: 100,  # コンクリート / コンクリート
    298: 100,  # コンベックス / 巻尺（凸型）
    299: 100,  # 作業用手袋 / 作業用手袋
}

# CSVを読み込み
csv_path = r'C:\python_script\test_space\MitsubishiMultipleTranslation\output\ユニークペア_batch2.csv'
df = pd.read_csv(csv_path, encoding='utf-8-sig', index_col=0)

print('=' * 80)
print('Claude AI 意味的類似度判定（バッチ2）')
print('=' * 80)
print(f'対象: {len(df)}ペア（インデックス 100-299）')
print()

# 判定結果を追加
df['類似度_claude'] = df.index.map(lambda idx: f'{claude_judgments.get(idx, 50)}%')

# 出力
output_csv = r'C:\python_script\test_space\MitsubishiMultipleTranslation\output\ユニークペア_batch2_claude判定.csv'
df.to_csv(output_csv, index=True, encoding='utf-8-sig')

print(f'✓ 出力: {output_csv}')
print()

# 統計
df['スコア'] = df['類似度_claude'].str.replace('%', '').astype(int)
print('統計情報:')
print(f'  100%（完全一致/完全同義）: {len(df[df["スコア"] == 100])}件')
print(f'  90%以上: {len(df[df["スコア"] >= 90])}件')
print(f'  80%以上: {len(df[df["スコア"] >= 80])}件')
print(f'  50%以上: {len(df[df["スコア"] >= 50])}件')
print(f'  50%未満: {len(df[df["スコア"] < 50])}件')
print(f'  平均スコア: {df["スコア"].mean():.1f}%')
print()

# 低スコアの例
print('低スコア例（50%未満）:')
low_score = df[df["スコア"] < 50]
if len(low_score) > 0:
    print(low_score[['単語', '再翻訳', '類似度_claude']].to_string())
else:
    print('  なし')

print()
print('=' * 80)
print('完了')
print('=' * 80)
