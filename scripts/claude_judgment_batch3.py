"""
Claude AI による意味的類似度判定（バッチ3: インデックス300-499）
"""
import sys
import io
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

import pandas as pd

# Claude AI判定結果（インデックス: スコア）
claude_judgments = {
    300: 100, # 差金 / カーペンターズスクエア
    301: 100, # 水平器 / レベル
    302: 100, # 墨さし / インクマーカー/インクブラシ
    303: 100, # 墨つぼ / チョークライン/インク壺
    304: 100, # 丸セパレーター / 丸型セパレーター
    305: 100, # 天端釘 / レベリングネイル/トップレベルネイル
    306: 100, # ケレン / チッピング/スクレーピング
    307: 100, # 型枠支保工 / 型枠サポート
    308: 100, # 基礎型枠 / 基礎型枠（金属型枠）
    309: 100, # 釘仕舞い / ネイルフィニッシュ/ネイルセット
    310: 100, # スラブ天端 / スラブトップレベル
    311: 60,  # 高さ（タッパ） / 身長（文脈で異なる）
    312: 100, # 建込み / 設定/インストール
    313: 100, # 通り / ライン/アライメント
    314: 100, # 蹴上げ / ライザー（階段）
    315: 100, # 蹴込み / トレッドノーズ/キックインボード
    316: 100, # 工具の手入れ / ツールのメンテナンス
    317: 100, # 下げ振り / プランボブ
    318: 100, # 地墨 / ベンチマークライン/グラウンドマーク
    319: 100, # 捨てコンクリート / 目くらましのコンクリート
    320: 100, # はね出し / オーバーハング/カンチレバー
    321: 100, # はらみ / 膨らんだ
    322: 90,  # 前面 / 正面/対面
    323: 100, # 養生 / 保護/硬化
    324: 100, # レベル / レベル
    325: 100, # 割付 / レイアウト/間隔
    326: 100, # 埋め込み金物 / 埋め込み金具
    327: 100, # 解体する（バラス） / 解体/撤去
    328: 100, # かぶり寸法 / コンクリートかぶり厚さ
    329: 100, # 異形棒鋼 / 異形鉄筋
    330: 100, # 結束線 / 結束ワイヤー
    331: 100, # 結束工具 / 結束具/ツイスター
    332: 100, # 鉄筋切断機 / 鉄筋カッター
    333: 100, # 鉄筋曲げ加工機 / 鉄筋曲げ機
    334: 100, # アンカー / アンカー
    335: 100, # 加工場 / 製造ヤード
    336: 100, # スペーサ― / スペーサー
    337: 100, # ドーナツ / ドーナツスペーサー
    338: 100, # 加工配筋図 / 鉄筋製作図
    339: 100, # 配筋詳細図 / 鉄筋詳細図
    340: 100, # 開口補強筋 / オープニング強化
    341: 100, # 幅止め筋 / スペーサーバー
    342: 100, # 差筋 / ダボバー
    343: 100, # 柱主筋 / メインカラムバー
    344: 100, # 柱配筋 / 柱の補強
    345: 100, # スラブ筋 / スラブ補強
    346: 100, # ベース筋 / 基礎補強
    347: 100, # 帯筋（フープ） / フープ/タイ
    348: 100, # 下端筋 / 下部バー
    349: 100, # 上端筋 / トップバー
    350: 100, # 主筋 / メインバー
    351: 100, # あばら筋 / あぶみ
    352: 100, # はかま筋 / ハウンチバー
    353: 100, # 縦筋 / 縦棒
    354: 100, # 下筋 / 下のバー
    355: 100, # 横筋 / 横バー
    356: 100, # 腹筋 / 配信バー（Webバー）
    357: 100, # 配力筋 / 流通強化
    358: 100, # 上筋 / 上部バー
    359: 100, # スパイラル筋 / スパイラル補強
    360: 100, # 鉄筋径 / 鉄筋直径
    361: 100, # かぶり厚さ / カバー厚
    362: 100, # ℝ度 / R（半径）サイズ
    363: 100, # シングル / シングル
    364: 100, # ダブル / ダブル
    365: 100, # 千鳥結束 / ずらし結び
    366: 100, # 切断寸法 / カット長さ
    367: 100, # 加工寸法 / 製作長さ
    368: 100, # 重ね継手 / ラップスプライス
    369: 100, # 圧接継手 / 圧力溶接スプライス
    370: 100, # 開口部 / オープニング
    371: 100, # 溶接金網 / 溶接金網
    372: 100, # 搬出 / 持ち出す/発送する
    373: 100, # 搬入 / 持ち込み・配達
    374: 95,  # 基礎 / 財団（foundationの2つの訳）
    375: 100, # 機械式継手 / メカニカルスプライス
    376: 100, # 配筋検査 / 鉄筋検査
    377: 100, # トラクタ / トラクター
    378: 100, # ブルドーザ / ブルドーザー
    379: 100, # トラクタショベル / トラックローダー
    380: 100, # ホイルローダ / ホイールローダー
    381: 100, # ダンプトラック / ダンプトラック
    382: 100, # 油圧ショベル / 油圧ショベル
    383: 100, # バックホウ / バックホー
    384: 100, # ローディングショベル / ローディングショベル
    385: 100, # ローラ / ローラー
    386: 100, # バケット / バケツ
    387: 100, # ブーム / ブーム
    388: 100, # アーム / アーム
    389: 100, # ブレード（排土板） / ブレード
    390: 100, # タイヤ / タイヤ
    391: 100, # クローラ / トラック/クローラー
    392: 100, # キー（鍵） / 鍵
    393: 80,  # 作業装置（アタッチメント） / 添付ファイル（誤訳の可能性）
    394: 100, # エンジン / エンジン
    395: 100, # ディーゼルエンジン / ディーゼルエンジン
    396: 100, # エンジンオイル / エンジンオイル
    397: 100, # オルタネータ / オルタネーター
    398: 100, # バッテリ / バッテリー
    399: 100, # 燃料 / 燃料
    400: 100, # 軽油 / ディーゼル燃料
    401: 100, # ブレーキ / ブレーキ
    402: 100, # 油圧シリンダ / 油圧シリンダー
    403: 100, # 油圧モータ / 油圧モーター
    404: 100, # 油圧ポンプ / 油圧ポンプ
    405: 100, # 水漏れ / 水漏れ
    406: 100, # 油漏れ / オイル漏れ
    407: 100, # 冷却水 / 冷却剤
    408: 100, # ブレーキ液 / ブレーキフルード
    409: 100, # 燃料タンク / 燃料タンク
    410: 100, # ファンベルト / ファンベルト
    411: 100, # 空気圧 / 空気圧
    412: 100, # クラッチ / クラッチ
    413: 100, # 発進 / スタート
    414: 100, # アイドリング / アイドリング
    415: 90,  # 走行 / 旅行/運転（文脈で異なる）
    416: 100, # 旋回 / スイング/回転
    417: 100, # 安全ロック / 安全ロック
    418: 100, # 安全支柱 / 安全支柱/サポート
    419: 100, # 補給（する） / 補充
    420: 40,  # 駐車（する） / 公園/駐車場（誤訳）
    421: 100, # 歩行者 / 歩行者
    422: 100, # 車両 / 車両
    423: 100, # 死角 / 死角
    424: 100, # 斜面 / スロープ
    425: 100, # 転圧（する） / 圧縮/コンパクト
    426: 100, # 接触（する） / 接触/タッチ
    427: 100, # 作動（する） / 操作/運用
    428: 100, # 整備（する） / サービス/メンテナンス
    429: 100, # 点検（する） / 検査
    430: 100, # 動かす / 移動/操作
    431: 100, # 運転（する） / 操作/運転
    432: 100, # 測る / 測定
    433: 100, # 操作（する） / 操作/運用
    434: 100, # 停止（する） / 停止/一時停止
    435: 100, # 切る / カット/オフ
    436: 100, # 回す / 回転
    437: 100, # 押す / 押す
    438: 100, # 集める / 集める/収集する
    439: 100, # 触る / 触る
    440: 100, # 縛る / 結ぶ/縛る
    441: 100, # 揃える / 整列/配置
    442: 100, # 結ぶ / ネクタイ/結び目
    443: 100, # しゃがむ / しゃがむ
    444: 100, # 調整（する） / 調整
    445: 100, # 閉じる / 閉じる
    446: 100, # 取り出す / テイクアウト
    447: 100, # 戻す / 返品する
    448: 100, # 仕上げる / 仕上げる
    449: 100, # 折れる / ブレーク/スナップ
    450: 100, # 欠ける / チップ/チップされる
    451: 100, # 近づく / アプローチ
    452: 100, # 電源を入れる / 電源を入れる
    453: 100, # 電源を落とす / 電源を切る
    454: 100, # スイッチを切る / スイッチをオフにする
    455: 95,  # 固定（する） / 修正/保護
    456: 100, # ゆるめる / 緩める
    457: 100, # 伸ばす / 伸ばす
    458: 100, # 外す / 取り除く
    459: 100, # 曲げる / 曲げる
    460: 100, # 出す / 出す/取り出す
    461: 100, # 乾かす / ドライ
    462: 100, # 数える / カウント
    463: 100, # 運ぶ / 持ち運び/輸送
    464: 100, # 積む / ロード/スタック
    465: 100, # 下ろす / 荷降ろし/降ろし
    466: 100, # 離れる / 立ち去る
    467: 100, # 位置 / 位置
    468: 100, # 寸法 / 寸法
    469: 100, # 測定（する） / 測定
    470: 100, # 計測（する） / 測定
    471: 100, # 計測器 / 測定器
    472: 100, # 温度 / 温度
    473: 100, # 高さ / 身長
    474: 100, # 長さ / 長さ
    475: 100, # 重さ / 重さ
    476: 100, # 厚さ / 厚さ
    477: 100, # 硬さ / 硬度
    478: 100, # 深さ / 深さ
    479: 100, # 表面 / 表面
    480: 100, # すきま / 隙間/クリアランス
    481: 100, # 中心 / 中心
    482: 80,  # 値 / 価値（文脈で異なる）
    483: 100, # 安定（する） / 安定性/安定化
    484: 100, # 大きさ / サイズ
    485: 100, # 数 / 数量
    486: 100, # 誤差 / エラー/許容範囲
    487: 100, # 中 / 内側/真ん中
    488: 100, # 反対 / 反対
    489: 100, # 周り / 周辺
    490: 100, # 尺 / 尺（伝統的な単位）/長さ
    491: 100, # 青 / 青
    492: 100, # 赤 / 赤
    493: 100, # 白 / 白
    494: 100, # 黄色 / 黄色
    495: 100, # 捨てる / 処分する
    496: 100, # 掃く / スイープ
    497: 100, # 持ち上げる / リフト
    498: 100, # 束ねる / バンドル
    499: 100, # 足をくじく / 足首を捻挫する
}

# CSVを読み込み
csv_path = r'C:\python_script\test_space\MitsubishiMultipleTranslation\output\ユニークペア_batch3.csv'
df = pd.read_csv(csv_path, encoding='utf-8-sig', index_col=0)

print('=' * 80)
print('Claude AI 意味的類似度判定（バッチ3）')
print('=' * 80)
print(f'対象: {len(df)}ペア（インデックス 300-499）')
print()

# 判定結果を追加
df['類似度_claude'] = df.index.map(lambda idx: f'{claude_judgments.get(idx, 50)}%')

# 出力
output_csv = r'C:\python_script\test_space\MitsubishiMultipleTranslation\output\ユニークペア_batch3_claude判定.csv'
df.to_csv(output_csv, index=True, encoding='utf-8-sig')

print(f'✓ 出力: {output_csv}')
print()

# 統計
df['スコア'] = df['類似度_claude'].str.replace('%', '').astype(int)
print('統計情報:')
print(f'  100%（完全一致/完全同義）: {len(df[df["スコア"] == 100])}件')
print(f'  90%以上: {len(df[df["スコア"] >= 90])}件')
print(f'  80%以上: {len(df[df["スコア"] >= 80])}件')
print(f'  50%以上: {len(df[df["スコア"] >= 50])}件')
print(f'  50%未満: {len(df[df["スコア"] < 50])}件')
print(f'  平均スコア: {df["スコア"].mean():.1f}%')
print()

# 低スコア例
print('低スコア例（80%未満）:')
low_score = df[df["スコア"] < 80]
if len(low_score) > 0:
    print(low_score[['単語', '再翻訳', '類似度_claude']].to_string())
else:
    print('  なし')

print()
print('=' * 80)
print('完了')
print('=' * 80)
