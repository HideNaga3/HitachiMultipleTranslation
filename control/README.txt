================================================================================
control - 処理実行制御フォルダ
================================================================================

このフォルダには、多言語翻訳プロジェクトの各種処理を実行するための
制御スクリプトが含まれています。

================================================================================
スクリプト一覧
================================================================================

【1. run_process.py】
  - 説明: メニュー形式で処理を選択して実行
  - 使用方法: python control\run_process.py
  - 機能:
    * 対話式メニューから処理を選択
    * 各処理を個別に実行
    * 処理の説明を表示

【2. run_all.py】
  - 説明: すべての処理を順番に一括実行
  - 使用方法: python control\run_all.py
  - 機能:
    * 38列Excel拡張
    * 類似度スコア追加
    * インポート用CSV + 比較Excel作成
    * エラー時の続行/中断選択

================================================================================
実行可能な処理
================================================================================

【処理1】インポート用CSV作成（38列）
  - スクリプト: scripts_main\output_functions.py csv
  - 出力: 成果物_20251023\01_全言語統合_テンプレート_インポート用.csv
  - 内容: core_filesから38列のインポート用CSVを作成

【処理2】インポート用CSV + 比較Excel作成
  - スクリプト: scripts_main\output_functions.py both
  - 出力:
    * 成果物_20251023\01_全言語統合_テンプレート_インポート用.csv
    * 成果物_20251023\02_逆翻訳_検証結果.xlsx
  - 内容: CSV + 翻訳・再翻訳・比較シート付きExcelを作成

【処理3】38列Excelに拡張
  - スクリプト: scripts_main\expand_excel_to_38cols.py
  - 出力: 成果物_20251023\02_逆翻訳_検証結果.xlsx（38列）
  - 内容: Excelシートを38列に拡張し、空セルを除外した比較シートを作成

【処理4】類似度スコア追加
  - スクリプト: scripts_main\add_similarity_score.py
  - 出力: 成果物_20251023\02_逆翻訳_検証結果.xlsx（類似度列追加）
  - 内容: 比較シートに類似度_difflib列と分類を追加

【処理5】シート名変更
  - スクリプト: scripts_main\rename_excel_sheets.py
  - 内容: Excelシート名を「翻訳」「再翻訳」に変更

【処理6】比較シート検証
  - スクリプト: scripts_main\verify_comparison_sheet.py
  - 出力: for_claude\comparison_preview.txt
  - 内容: 比較シートの内容を確認・統計表示

【処理7】38列Excel検証
  - スクリプト: scripts_main\verify_38cols_excel.py
  - 内容: 38列Excelファイルの内容を検証

【処理8】類似度例表示
  - スクリプト: scripts_main\show_similarity_examples.py
  - 出力: for_claude\similarity_examples.txt
  - 内容: 類似度スコア付き比較シートの例を表示

【処理9】ログ保存
  - スクリプト: scripts_main\save_project_log.py
  - 出力: for_claude\log_session_YYYYMMDD_HHMMSS.txt
  - 内容: セッション終了時のログを保存

【処理10】成果物検証
  - スクリプト: scripts_main\verify_deliverables.py
  - 出力: for_claude\verification_result.txt
  - 内容: CSV/Excelファイルの整合性を自動検証

================================================================================
使用例
================================================================================

【例1: メニューから処理を選択】

> python control\run_process.py

メニューが表示されるので、実行したい処理の番号を入力します。

【例2: すべての処理を一括実行】

> python control\run_all.py

確認メッセージの後、すべての処理が順番に実行されます。

【例3: 特定の処理を直接実行】

> python scripts_main\expand_excel_to_38cols.py

scripts_mainフォルダのスクリプトを直接実行できます。

================================================================================
推奨実行順序
================================================================================

新しく逆翻訳データを作成した場合:

1. expand_excel_to_38cols.py
   → Excelシートを38列に拡張、空セル除外

2. add_similarity_score.py
   → 類似度スコアと分類を追加

3. output_functions.py both
   → インポート用CSVと比較Excelを作成

または、run_all.py で一括実行。

================================================================================
エラーが発生した場合
================================================================================

【エラー1: スクリプトが見つかりません】
  - 原因: scripts_mainフォルダにスクリプトが存在しない
  - 対処: スクリプトファイルの存在を確認

【エラー2: ファイルが見つかりません】
  - 原因: 入力ファイル（Excel、CSVなど）が存在しない
  - 対処: 前の処理を実行して入力ファイルを作成

【エラー3: Pythonモジュールがない】
  - 原因: 必要なライブラリがインストールされていない
  - 対処: pip install -r requirements.txt

================================================================================
注意事項
================================================================================

1. 【仮想環境】
   - 必ず .venv 仮想環境を有効化してから実行
   - コマンド: .venv\Scripts\activate

2. 【実行ディレクトリ】
   - プロジェクトルートから実行推奨
   - 相対パスが正しく解決されます

3. 【ファイルの上書き】
   - 成果物フォルダ内のファイルは上書きされます
   - バックアップが必要な場合は事前にコピー

4. 【Google API】
   - reverse_translate_to_japanese.py は .env ファイルが必要
   - GOOGLE_API_KEY を設定

================================================================================
トラブルシューティング
================================================================================

【問題: 処理が途中で止まる】
  - 確認: エラーメッセージを確認
  - 対処: エラーログを確認して該当箇所を修正

【問題: Excelファイルが開けない】
  - 原因: ファイルが他のプログラムで開かれている
  - 対処: Excelを閉じてから再実行

【問題: 文字化けが発生】
  - 原因: エンコーディングの問題
  - 対処: UTF-8 BOM エンコーディングを確認

================================================================================
